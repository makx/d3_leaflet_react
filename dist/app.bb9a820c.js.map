{"version":3,"sources":["webpack:///./src/Map/Map.js","webpack:///./src/Barchart/Barchart.js","webpack:///./src/Controls/Controls.js","webpack:///./src/HorizBarChart/HorizBarChart.js","webpack:///./src/HorizonChart/HorizonChart.js","webpack:///./src/App.js","webpack:///./src/index.js"],"names":["require","react_default","a","createElement","TileLayer","attribution","url","Popup","MapSpain","props","_classCallCheck","this","_this","_possibleConstructorReturn","_Component","call","state","lat","lng","zoom","render","data","position","Col","xs","sm","md","_ref","Map","className","center","_ref2","react_leaflet_markercluster_min_default","length","map","item","key","Marker","latitude","longitude","_ref3","Component","BarChart","componentWillUnmount","d3","remove","_props","purchasesByManufacturer","purchasesByProduct","slice","label","value","Math","round","income","drawChart","Barchart_ref","margin","chart","append","attr","classed","chartWidth","chartHeight","plot","width","height","xScale","domain","d","range","yScale","colorScale","selectAll","enter","bandwidth","style","i","text","xAxis","scale","yAxis","ticks","select","yGridlines","tickSize","tickFormat","React","Controls","Controls_classCallCheck","Controls_possibleConstructorReturn","_React$Component","showProductSelect","handleChange","option","onSelect","clearManufacturer","setState","Boolean","handleChangeProduct","onSelectProduct","clearProduct","getOptions","manufacturers","parseInt","currentManufacturer","products","currentProduct","manufacturerOptions","Fragment","react_select_esm","find","onChange","bind","options","isClearable","placeholder","HorizBarChart","componentDidMount","svg","x","parseFloat","y","padding","format","console","log","g","tickSizeOuter","HorizBarChart_ref","HorizonChart","HorizonChart_classCallCheck","HorizonChart_possibleConstructorReturn","componentWillReceiveProps","nextProps","loadGraph","componentWillMount","_this2","purchases","name","product_id","date","Date","getTime","roundToHour","date_add","total_paid","dates","entries","sort","values","rollup","v","sums","series","b","get","HorizonChart_ref2","area","curve","defined","isNaN","y0","y1","clip","uniqueId","path","window","location","origin","Array","fill","max","color","step","filter","node","fa","App","App_classCallCheck","App_possibleConstructorReturn","updating","rawData","row","push","then","rows","getPurchasesByManufacturer","componentWillUpdate","nextState","filterItemsByManufacturer","id_manufacturer","filterData","getPurchasesByProduct","filterItemsByProduct","JSON","parse","stringify","clearData","clearOptionManufacturer","reload","clearOptionProduct","product_quantity","getPurchasesByCity","city","_state","App_ref","Controls_Controls","Grid","Row","Map_MapSpain","HorizBarChart_HorizBarChart","Barchart_BarChart","HorizonChart_HorizonChart","src_App_0","document","querySelector"],"mappings":"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","file":"app.bb9a820c.js","sourcesContent":["import React, { Component } from 'react'\nimport { Map, TileLayer, Marker, Popup } from 'react-leaflet'\nrequire('react-leaflet-markercluster/dist/styles.min.css')\nimport * as d3 from \"d3\";\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\nimport { Col } from 'react-bootstrap';\n\n\nexport default class MapSpain extends Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      lat: 40.41,\n      lng: -3.70,\n      zoom: 5.5\n    }\n  }\n\n  render() {\n    const {\n      data\n    } = this.props\n    const position = [this.state.lat, this.state.lng]\n    return (\n        <Col xs={12} sm={12} md={4}>\n              <h2>Ventas en España y Portugal</h2>\n              <Map className='map-spain' center={position} zoom={this.state.zoom}>\n                <TileLayer\n                  attribution=\"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors\"\n                  url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                />\n                  <MarkerClusterGroup>\n                    {\n                      data.length && data.map((item, key) => (\n                        <Marker key={key} position={{lat: item.latitude, lng: item.longitude}}>\n                          <Popup>\n                            A pretty CSS3 popup. <br /> Easily customizable.\n                          </Popup>\n                        </Marker>\n                      ))\n                    }\n                  </MarkerClusterGroup>\n              </Map>\n          </Col>\n    )\n  }\n}\n","import React from 'react'\nimport * as d3 from 'd3'\nimport { Col } from 'react-bootstrap';\n\nexport default class BarChart extends React.Component {\n\n  componentWillUnmount () {\n    d3.select(\".bar-chart > *\").remove()\n  }\n\n  render () {\n    const {\n      purchasesByManufacturer,\n      purchasesByProduct\n    } = this.props\n\n    d3.select(\".bar-chart > *\").remove()\n    const data = purchasesByManufacturer.slice(0, 9).map(item => {\n      return {\n        label: item.key,\n        value: Math.round(item.value.income*10)/10\n      }\n    })\n    this.drawChart(data)\n    return (\n        <Col xs={12} sm={12} md={8}>\n          <h2>Ventas por Fabricante</h2>\n          <div className='bar-chart'>\n          </div>\n        </Col>\n\n    )\n  }\n\n  drawChart(data) {\n    const width = 700;\n    const height = 450;\n\n    const svg = d3.select(\".bar-chart\")\n        .append('svg')\n        .attr('id', 'chart')\n        .attr('width', width)\n        .attr('height', height);\n\n    const margin = {\n        top: 20,\n        bottom: 80,\n        left: 80,\n        right: 40\n    };\n\n    const chart = svg.append('g')\n        .classed('display', true)\n        .attr('transform', `translate(${margin.left},${margin.top})`);\n\n    const chartWidth = width - margin.left - margin.right;\n    const chartHeight = height - margin.top - margin.bottom\n    this.plot(chart, chartWidth, chartHeight, data);\n  }\n\n\n\n\n\n  plot(chart, width, height, data) {\n    // create scales!\n    const xScale = d3.scaleBand()\n        .domain(data.map(d => d.label))\n        .range([0, width]);\n    const yScale = d3.scaleLinear()\n        .domain([0, d3.max(data, d => d.value) + 1000])\n        .range([height, 0]);\n    const colorScale = d3.scaleOrdinal(d3.schemeCategory10);\n\n    chart.selectAll('.bar')\n        .data(data)\n        .enter()\n        .append('rect')\n        .classed('bar', true)\n        .attr('x', d => xScale(d.label))\n        .attr('y', d => yScale(d.value))\n        .attr('height', d => (height - yScale(d.value)))\n        .attr('width', d => xScale.bandwidth())\n        .style('fill', (d, i) => colorScale(i));\n\n    chart.selectAll('.bar-label')\n        .data(data)\n        .enter()\n        .append('text')\n        .classed('bar-label', true)\n        .attr('x', d => xScale(d.label) + xScale.bandwidth()/2)\n        .attr('dx', 0)\n        .attr('y', d => yScale(d.value))\n        .attr('dy', -6)\n        .text(d => d.value);\n\n    const xAxis = d3.axisBottom()\n        .scale(xScale);\n\n    chart.append('g')\n        .classed('x axis', true)\n        .attr('transform', `translate(0,${height})`)\n        .call(xAxis);\n\n    const yAxis = d3.axisLeft()\n        .ticks(5)\n        .scale(yScale);\n\n    chart.append('g')\n        .classed('y axis', true)\n        .attr('transform', 'translate(0,0)')\n        .call(yAxis);\n\n    chart.select('.x.axis')\n        .append('text')\n        .attr('x',  width/2)\n        .attr('y', 60)\n        .attr('fill', '#000')\n        .style('font-size', '18px')\n        .style('text-anchor', 'middle')\n        .text('Fabricante ID');\n\n    chart.select('.y.axis')\n        .append('text')\n        .attr('x', 0)\n        .attr('y', 0)\n        .attr('transform', `translate(-50, ${height/2}) rotate(-90)`)\n        .attr('fill', '#000')\n        .style('font-size', '18px')\n        .style('text-anchor', 'middle')\n        .text('Ventas');\n\n    const yGridlines = d3.axisLeft()\n        .scale(yScale)\n        .ticks(5)\n        .tickSize(-width,0,0)\n        .tickFormat('')\n\n    chart.append('g')\n        .call(yGridlines)\n        .classed('gridline', true);\n  }\n}\n","import React from 'react'\nimport Select from 'react-select'\n\n\nexport default class Controls extends React.Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      showProductSelect: false\n    }\n  }\n  handleChange (option) {\n    if (option) this.props.onSelect(option.value)\n    else this.props.clearManufacturer()\n    this.setState({showProductSelect: Boolean(option)})\n  }\n  handleChangeProduct (option) {\n    if (option) this.props.onSelectProduct(option.value)\n    else this.props.clearProduct()\n  }\n\n  getOptions (manufacturers) {\n    return manufacturers.map(item => {\n      return {\n        value: parseInt(item),\n        label: \"Fabricante \" + parseInt(item)\n      }\n  }).slice(0,100)\n  }\n\n  render () {\n    const {\n      manufacturers,\n      currentManufacturer,\n      currentProduct,\n      products,\n      showProductSelect\n    } = this.props\n\n    const productOptions = this.getOptions(products)\n    const manufacturerOptions = this.getOptions(manufacturers)\n    return (\n      <React.Fragment>\n        <div className='select-manufacturers pull-right'>\n          <Select\n            value={manufacturerOptions.find(item => item.value == currentManufacturer)}\n            onChange={this.handleChange.bind(this)}\n            options={this.getOptions(manufacturers)}\n            isClearable={true}\n            placeholder=\"Fabricante...\"\n            />\n        </div>\n        {/* {this.state.showProductSelect?\n        <div className='select-product'>\n          <label>Producto: </label>\n          <Select\n            value={productOptions.find(item => item.value == currentProduct)}\n            onChange={this.handleChangeProduct.bind(this)}\n            options={this.getOptions(products)}\n            isClearable={true}\n            />\n        </div> : null }*/}\n      </React.Fragment>\n    )\n  }\n}\n","import React from 'react'\nimport data from './sample.js'\n\nimport * as d3 from 'd3'\nimport { Col } from 'react-bootstrap';\n\n\nexport default class HorizBarChart extends React.Component {\n\n  componentDidMount () {\n    this.drawChart()\n  }\n\n  drawChart () {\n    let data = this.props.purchasesByProduct.slice(0,14)\n    let margin = ({top: 30, right: 0, bottom: 10, left: 30})\n    let height = data.length * 25 + margin.top + margin.bottom\n    let width = 600\n    const svg = d3.select('.horizontal-bar-chart')\n      .append('svg')\n      .attr('height', height)\n      .attr('width', width)\n\n    let x = d3.scaleLinear()\n      .domain([0, d3.max(data, d => parseFloat(d.value.income))])\n      .range([margin.left, width - margin.right])\n\n    let y = d3.scaleBand()\n      .domain(data.map(d => d.key))\n      .range([margin.top, height - margin.bottom])\n      .padding(0.1)\n\n    let xAxis = g => g\n      .classed('x axis', true)\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n      .call(d3.axisBottom(x).ticks(width / 80))\n      // .call(g => g.select(\".domain\").remove())\n\n    let yAxis = g => g\n      .classed('y axis', true)\n      .attr(\"transform\", `translate(${margin.left},0)`)\n      .call(d3.axisLeft(y).tickSizeOuter(0))\n\n    let format = d3.format(\".3f\")\n    console.log('la data importada', data)\n    svg.append(\"g\")\n        .attr(\"fill\", \"steelblue\")\n      .selectAll(\"rect\")\n      .data(data)\n      .enter().append(\"rect\")\n        .attr(\"x\", x(0))\n        .attr(\"y\", d => y(d.key))\n        .attr(\"width\", d => x(parseFloat(d.value.income)) - x(0))\n        .attr(\"height\", y.bandwidth());\n\n    svg.append(\"g\")\n        .attr(\"fill\", \"white\")\n        .attr(\"text-anchor\", \"end\")\n        .style(\"font\", \"12px sans-serif\")\n      .selectAll(\"text\")\n      .data(data)\n      .enter().append(\"text\")\n        .attr(\"x\", d => x(parseFloat(d.value.income)) - 4)\n        .attr(\"y\", d => y(d.key) + y.bandwidth() / 2)\n        .attr(\"dy\", \"0.35em\")\n        .attr(\"dx\", \"4em\")\n        .attr('fill', '#000')\n        .text(d => format(parseFloat(d.value.income)));\n\n    svg.append(\"g\")\n        .call(xAxis);\n\n    svg.append(\"g\")\n        .call(yAxis);\n\n    svg.select('.x.axis')\n      .append('text')\n      .attr('x',  width/2)\n      .attr('y', 40)\n      .attr('fill', '#000')\n      .style('font-size', '18px')\n      .style('text-anchor', 'middle')\n      .text('Ventas (€)');\n\n    svg.select('.y.axis')\n      .append('text')\n      .attr('x', 0)\n      .attr('y', 0)\n      .attr('transform', `translate(-50, ${height/2}) rotate(-90)`)\n      .attr('fill', '#000')\n      .style('font-size', '18px')\n      .style('text-anchor', 'middle')\n      .text('Producto ID')\n\n  }\n\n  render () {\n    return(\n        <Col xs={12} sm={12} md={8}>\n          <h2>Ventas por productos</h2>\n          <div className='horizontal-bar-chart'></div>\n        </Col>\n    )\n  }\n\n}\n","import React from 'react'\nimport ReactDOM from \"react-dom\";\nimport * as d3 from 'd3'\nimport { Col } from 'react-bootstrap';\nimport { uniqueId } from 'lodash'\n\nexport default class HorizonChart extends React.Component {\n\n    constructor() {\n        super();\n        this.state = { data: [] };\n    }\n\n\n    componentWillReceiveProps(nextProps) {\n        if(nextProps.data.length != this.props.data.length) {\n            this.loadGraph(nextProps.data)\n        }\n    }\n\n    componentWillMount () {\n        this.loadGraph(this.props.data)\n    }\n\n    loadGraph(data) {\n        var purchases = data\n        purchases = purchases.map(item => { return {name: item.product_id, date: roundToHour(new Date(item.date_add)).getTime(), value: parseFloat(item.total_paid)}})\n        const dates = d3.nest()\n            .key(d => d.date)\n            .entries(purchases)\n            .map(d => {\n                return d.key\n            })\n            .sort(d3.ascending)\n    \n\n        const values = d3.nest()\n            .key(d => d.name)\n            .key(d => d.date)\n            .rollup(v => v[0].value)\n            .map(purchases)\n\n        const sums = d3.nest()\n            .key(d => d.name)\n            .rollup(v => d3.sum(v, d => d.value))\n            .map(purchases)\n\n        this.setState({\n            data: {\n                series: values.entries()\n                    .sort((a, b) => sums.get(b.key) - sums.get(a.key))\n                    .map(({key, value}) => ({\n                        name: key,\n                        values: dates.map(d => {\n                            return value.get(+d)? value.get(+d) : 0\n                        })\n                    })),\n                dates\n                }\n        }, () => this.drawChart(this.state.data))\n    }\n\n    render () {\n        this.drawChart(this.state.data)\n        return (\n            <Col xs={12} sm={12} md={12}>\n                <h2>Ventas en el tiempo</h2>\n                <div className='horizon-chart'>\n                </div>\n            </Col>\n        )\n    }\n\n    drawChart(data){\n        const scheme = \"schemeRdPu\";\n        const overlap = 5;\n        const step = 23;\n        const color = i => d3[scheme][Math.max(3, overlap)][i + Math.max(0, 3 - overlap)]\n        const margin = ({top: 30, right: 10, bottom: 0, left: 10})\n        const width = 964;\n        // const height = data.series.length * (step) + margin.top + margin.bottom\n        const height = 'auto'\n\n        let x = d3.scaleUtc()\n            .domain(d3.extent(data.dates))\n            .range([0, width]);\n\n        let y = d3.scaleLinear()\n            .domain([0, d3.max(data.series, d => d3.max(d.values))])\n            .range([0, -overlap * step]);\n\n        let area = d3.area()\n            .curve(d3.curveBasis)\n            .defined(d => !isNaN(d))\n            .x((d, i) => x(data.dates[i]))\n            .y0(0)\n            .y1(d => y(d));\n\n        const svg = d3.select(\".horizon-chart\")\n            .append('svg')\n            .attr('width', width)\n            .attr('height', height)\n            .attr('viewBox', '0,0,964,942')\n            .style(\"font\", \"10px sans-serif\");\n\n        const g = svg.append(\"g\")\n            .selectAll(\"g\")\n            .data(data.series)\n            .enter().append(\"g\")\n            .attr(\"transform\", (d, i) => `translate(0,${i * (step + 1) + margin.top})`);\n\n        g.append(\"clipPath\")\n            .attr(\"id\", d => (d.clip = uniqueId(\"clip\")))\n            .append(\"rect\")\n            .attr(\"width\", width)\n            .attr(\"height\", step);\n\n        g.append(\"defs\").append(\"path\")\n            .attr(\"id\", d => (d.path = uniqueId(\"path\")))\n            .attr(\"d\", d => area(d.values));\n            //.attr(\"fake\", d => console.log(d.values));\n\n        g.append(\"g\")\n            .attr(\"clip-path\", d => 'url('+window.location.origin+'/#' + d.clip + ')')\n            .selectAll(\"use\")\n            .data(d => new Array(overlap).fill(d))\n            .enter().append(\"use\")\n            .attr(\"fill\", (d, i) => color(i))\n            .attr(\"transform\", (d, i) => `translate(0,${(i + 1) * step})`)\n            .attr(\"xlink:xlink:href\", d => window.location.origin+'/#'+ d.path);\n\n        g.append(\"text\")\n            .attr(\"x\", 4)\n            .attr(\"y\", step / 2)\n            .attr(\"dy\", \"0.35em\")\n            .text(d => d.name);\n\n        let xAxis = g => g\n            .attr(\"transform\", `translate(0,${margin.top})`)\n            .call(d3.axisTop(x).ticks(width / 80).tickSizeOuter(0))\n            .call(g => g.selectAll(\".tick\").filter(d => x(d) < margin.left || x(d) >= width - margin.right).remove())\n            .call(g => g.select(\".domain\").remove());\n\n        svg.append(\"g\")\n            .call(xAxis);\n\n        return svg.node();\n    }\n}\n\nfunction roundToHour(date) {\n    let p = 60 * 60 * 1000; // milliseconds in an hour\n    return new Date(Math.round(date.getTime() / p ) * p);\n  }\n  \n","import React, {Component} from 'react'\nimport './App.css'\n\n/* D3 */\nimport * as d3 from 'd3'\nimport MapSpain from './Map/Map.js'\nimport BarChart from './Barchart/Barchart.js'\nimport Controls from './Controls/Controls.js'\nimport HorizBarChart from './HorizBarChart/HorizBarChart.js'\nimport HorizonChart from './HorizonChart/HorizonChart.js'\n\n/* BOOTSTRAP */\nimport { Grid,Row } from 'react-bootstrap';\n\n/* ICONS */\nimport { FaChartBar } from 'react-icons/fa'\n\nclass App extends Component {\n\n  constructor (props) {\n    super(props)\n    this.state = {\n      updating: false,\n      rawData: [],\n      data: [],\n      manufacturers: [],\n      currentManufacturer: null,\n      products: [],\n      currentProduct: null,\n      purchasesByManufacturer: [],\n      purchasesByProduct: []\n    }\n  }\n\n  componentWillMount () {\n    var purchases = []\n    d3.tsv(\n        './pedidosCordenados.tsv',\n        function (data) {},\n        function (row) { purchases.push(row)}\n    ).then((rows) => {\n      let purchasesByManufacturer = this.getPurchasesByManufacturer(purchases).sort((a, b) => {\n        return b.value.income - a.value.income\n      })\n      // let purchasesByProduct = this.getPurchasesByProduct(purchases).sort((a, b) => {\n      //   return b.value.income - a.value.income\n      // })\n      this.setState({\n        rawData: purchases,\n        data: purchases,\n        purchasesByManufacturer: purchasesByManufacturer,\n        // purchasesByProduct: purchasesByProduct\n      })\n    })\n  }\n\n  componentWillUpdate (nextProps, nextState) {\n    console.log('se dispara el will update')\n  }\n\n  filterItemsByManufacturer (option) {\n    let id_manufacturer = parseInt(option)\n    const data = this.filterData(option, this.state.currentProduct)\n    let purchasesByManufacturer = this.getPurchasesByManufacturer(data).sort((a, b) => {\n      return b.value.income - a.value.income\n    })\n    let purchasesByProduct = this.getPurchasesByProduct(data).sort((a, b) => {\n      return b.value.income - a.value.income\n    })\n    this.setState({\n      data: data,\n      currentManufacturer: id_manufacturer,\n      purchasesByManufacturer,\n      purchasesByProduct\n    })\n  }\n\n  filterItemsByProduct (option) {\n    let product_id = parseInt(option)\n    const data = this.filterData(this.state.currentManufacturer, option)\n    let purchasesByManufacturer = this.getPurchasesByManufacturer(data).sort((a, b) => {\n      return b.value.income - a.value.income\n    })\n    let purchasesByProduct = this.getPurchasesByProduct(data).sort((a, b) => {\n      return b.value.income - a.value.income\n    })\n    this.setState({\n      data: data,\n      currentProduct: product_id,\n      purchasesByManufacturer,\n      purchasesByProduct\n    })\n  }\n\n  filterData (id_manufacturer, product_id) {\n    let data = JSON.parse(JSON.stringify(this.state.rawData))\n    // let product_id\n    // let id_manufacturer\n    // if (optionName == 'product') {\n    //   product_id = option\n    //   id_manufacturer = this.state.currentManufacturer\n    // } else {\n    //   product_id = this.state.currentProduct\n    //   id_manufacturer = option\n    // }\n    return data.filter(item => {\n      if(product_id && id_manufacturer) {\n        return (item.id_manufacturer == id_manufacturer) && (item.product_id == product_id)\n      } else if (!id_manufacturer && product_id) {\n        return (item.product_id == product_id)\n      } else if (!product_id && id_manufacturer) {\n        return (item.id_manufacturer == id_manufacturer)\n      } else {\n        return true\n      }\n    })\n  }\n\n  clearData () {\n    this.setState({\n      data\n    })\n  }\n\n  clearOptionManufacturer () {\n    location.reload()\n    // const data = this.filterData(null, this.state.currentProduct)\n    // let purchasesByManufacturer = this.getPurchasesByManufacturer(data).sort((a, b) => {\n    //   return b.value.income - a.value.income\n    // })\n    // let purchasesByProduct = this.getPurchasesByProduct(data).sort((a, b) => {\n    //   return b.value.income - a.value.income\n    // })\n    // let purchasesByProduct = []\n    // this.setState({\n    //   currentManufacturer: null,\n    //   data,\n    //   purchasesByManufacturer,\n    //   purchasesByProduct\n    // })\n  }\n\n  clearOptionProduct () {//DEPRECATED\n    // let data = JSON.parse(JSON.stringify(this.state.rawData))\n    const data = this.filterData(this.state.currentManufacturer, null)\n    let purchasesByManufacturer = this.getPurchasesByManufacturer(data).sort((a, b) => {\n      return b.value.income - a.value.income\n    })\n\n    let purchasesByProduct = this.getPurchasesByProduct(data).sort((a, b) => {\n      return b.value.income - a.value.income\n    })\n    this.setState({\n      currentProduct: null,\n      data,\n      purchasesByManufacturer,\n      purchasesByProduct\n    })\n  }\n\n  getPurchasesByManufacturer (data) {\n    return d3.nest()\n      .key(function(d) { return d.id_manufacturer; })\n      .rollup(function(rows) { return {\"length\": rows.length, \"income\": d3.sum(rows, function(d) {return parseFloat(d.total_paid);})} })\n      .entries(data);\n  }\n\n  getPurchasesByProduct (data) {\n    return d3.nest()\n      .key(function(d) { return d.product_id; })\n      .rollup(function(rows) { return {\"length\": d3.sum(rows, function(d) {return parseFloat(d.product_quantity);}) , \"income\": d3.sum(rows, function(d) {return parseFloat(d.total_paid);})} })\n      .entries(data)\n  }\n\n  getPurchasesByCity () {\n    return d3.nest()\n      .key(function(d) { return d.city})\n      .rollup(function(rows) { return {\"length\": d3.sum(rows, function(d) {return parseFloat(d.product_quantity)}, )}})\n  }\n\n  render() {\n    const {\n      data,\n      currentManufacturer,\n      currentProduct,\n      updating,\n      purchasesByManufacturer,\n      purchasesByProduct\n    } = this.state\n\n    const products = purchasesByProduct.map(item => item.key)\n    const manufacturers = purchasesByManufacturer.map(item => item.key)\n    console.log('el current manufacturer ', currentManufacturer)\n\n    return <div className=\"App\">\n      <div className=\"App-instructions\">\n        <div className='header'>\n          <h3 className=\"pull-left\"><FaChartBar /> Dashboard de Ventas</h3>\n          <Controls\n            manufacturers={manufacturers}\n            currentManufacturer={currentManufacturer}\n            products={products}\n            currentProduct={currentProduct}\n            onSelect={this.filterItemsByManufacturer.bind(this)}\n            onSelectProduct={this.filterItemsByProduct.bind(this)}\n            clearProduct={this.clearOptionProduct.bind(this)}\n            clearManufacturer={this.clearOptionManufacturer.bind(this)}\n            />\n        </div>\n      </div>\n      <div className=\"App-content\">\n        {!updating &&\n        <Grid className=\"container-fluid\">\n        <Row className=\"show-grid\">\n        {data.length &&  <MapSpain data={data} />}\n        {!currentManufacturer ?\n          <BarChart\n          currentManufacturer={currentManufacturer}\n          purchasesByManufacturer={purchasesByManufacturer}\n          purchasesByProduct={purchasesByProduct}  />\n          : <HorizBarChart purchasesByProduct={purchasesByProduct} />\n        }\n        </Row>\n        <Row className=\"show-grid\">\n          {data.length && <HorizonChart data={data} />}\n        </Row>\n        </Grid>}\n      </div>\n    </div>\n  }\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport {render} from 'react-dom'\n\nimport App from './App'\n\nrender(<App/>, document.querySelector('#app'))\n"],"sourceRoot":""}